# Declarative MLIR Compilers

[Design document](https://docs.google.com/document/d/1eAgIQZZ2dItJFSrCxemt7fwH0CD4w6_ueLKVl6UL-NU/edit?usp=sharing)

## Building DMC

Build requirements:

- `cmake >= 3.10`
- `python >= 3.6`

Arch Linux:

```
sudo pacman -Sy cmake python
```

MacOS:

```
brew install cmake python3
```

Clone the repo and its submodules. Configure CMake with whatever generator you
prefer and then build the target `gen`.

```
cmake --build $BINDIR --target gen
```

## Using DMC

## Building the Lua Compiler

The Lua compile requires `antlr >= 4`. On Arch, install the Pacman package
`antlr4`. On MacOS, install the Homebrew package `antlr`.

First, build the CMake targets `mlir`, `mlir-translate`, and `lua-parser`.

```
cmake --build $BINDIR -t mlir -t mlir-translate -t lua-parser
```

The Python shared library and autogenerated Lua parser must be added to your
`PYTHONPATH`. These can be found under `$BINDIR/lua/parser` and
`$BINDIR/lib/Python`.

```
export PATH=$PATH:$BINDIR/tools:$BINDIR/llvm-project/llvm/bin:$BINDIR/lua
export PYTHONPATH=$BINDIR/lua/parser:$BINDIR/lib/Python
```

## Using the Lua Compiler

Let's define a basic Lua file.
